<%- include('../../../templates/CVO-Head-Location.ejs') -%>
<script>

document.getElementById("impoundingsite_list").className="active";
document.getElementById("maintenance_list").className="active";

</script>


<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="card">
            <div class="header bg-blue" >
                <h2>
                IMPOUNDING SITE
                </h2>
            </div>
            <div class="body">
                <div class="row clearfix">
                    <div >
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs tab-nav-right" role="tablist" >
                            <li role="presentation" class="active"><a href="#home_animation_2" data-toggle="tab" aria-expanded="false"><i class="material-icons">list</i>LIST</a></li>
                            <li role="presentation" class=""><a href="#profile_animation_2" data-toggle="tab" aria-expanded="false"><i class="material-icons">add</i>ADD</a></li>
                          </ul>

                        <!-- Tab panes -->
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane animated fadeInRight active" id="home_animation_2">
                                    <div class="body">
                                            <div class="table-responsive">
                                                <table class="table table-bordered table-striped table-hover js-basic-example dataTable">
                                                    <thead>
                                                        <tr>
                                                            <th>ID</th>
                                                            <th>Barangay Located</th>
                                                            <th>Number Of Cages</th>
                                                            <th>Status</th>
                                                            <th>QR Code</th>
															                              <th>Action</th>
                                                        </tr>
                                                    </thead>

                                                    <tbody>
                                                      <% re.forEach(function(i){ %>
                                                        <tr>
                                                            <td><%= i.int_ImpoundingSiteId %></td>
                                                            <td><%= i.str_BarangayName %></td>
															                              <td><%= i.numberofcages %></td>
															                              <td>
                                                              <% if(i.int_Status==1){ %>
                                                               <div class="switch" align="center">
                                                                    <label><input type="checkbox" checked ><span class="lever switch-col-blue"></span></label>
                                                                    <span>Active</span>
                                                                </div>
                                                                <% }else{ %>
                                                                  <div class="switch" align="center">
                                                                       <label><input type="checkbox" ><span class="lever switch-col-blue"></span></label>
                                                                       <span>Inactive</span>
                                                                   </div>
                                                                   <% } %>
                                                            </td>
                                                            <td>
                                                              <div align="center">
                                                                  <a data-target="#modal_qr" data-toggle="modal"  ><button type="button" class="qr btn btn-primary waves-effect"  data-toggle="tooltip" data-placement="top" title="QR Code" data-qr1="<%= i.int_ImpoundingSiteId %>" onclick="generateqr(<%= i.int_ImpoundingSiteId %>);">
                                                                        QR CODE
                                                                  </button></a>
                                                              </div>
                                                            </td>
                                                            <td>
                                                                <div align="center">
                                                                    <form method="POST" action="/CVO_ImpoundingCage">
                                                                        <button type="submit" class="btn btn-primary waves-effect" data-toggle="tooltip" data-placement="top" title="Cages">
                                                                                <i class="material-icons">apps</i>
                                                                        </button>
                                                                    </form>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                      <% }); %>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                            </div>
                            <div role="tabpanel" class="tab-pane animated fadeInRight" id="profile_animation_2">
                               <%- include('./addImpoundingSite.ejs') -%>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modal_qr" tabindex="-1" role="dialog">
                 <div class="modal-dialog" role="document">
                     <div class="modal-content">
                         <div class="modal-header bg-blue">
                             <h4 class="modal-title" id="defaultModalLabel">QR CODE</h4>
                         </div>
                         <div class="modal-body">
                           <center>
                             <script type="text/javascript" src="QR-Code/jquery.min.js"></script>
                              <script type="text/javascript" src="QR-Code/qrcode.js"></script>
                              <div id="printqr">
                              <div id="qrcode"></div>
                              <h4 id="modal_qr1" ></h4>
                            </div>
                              <script type="text/javascript">
                              function generateqr(x){
                            document.getElementById("qrcode").innerHTML="";
                              var qrcode = new QRCode(document.getElementById("qrcode"), {
                              	text: x+"",
                              	width: 200,
                              	height: 200,
                              	colorDark : "#3498DB",
                              	colorLight : "#ffffff",
                              	correctLevel : QRCode.CorrectLevel.H
                              });
                            }
                              </script>


                           </center>
                         </div>
                         <div class="modal-footer">
                           <center>

                             <button type="button" class="btn btn-primary waves-effect" data-dismiss="modal" onclick="printDiv('printqr');">DOWNLOAD</button>

                             <!--- NOTE: THIS PART IS PANG SAVE SANA AS PNG NG GENERATED QR CODE KASO SADLY EPIC FAIL PA SIYA.-sean
                             <script>
                                function printDiv(divName) {
                                     var printContents = document.getElementById(divName).innerHTML;
                                     var bodyoriginalContents = document.body.innerHTML;
                                     document.body.innerHTML = printContents;
                                     window.print();
                                     document.body.innerHTML = bodyoriginalContents;
                                  }
                            </script> --->
                             <button type="button" class="btn btn-gray waves-effect" data-dismiss="modal">CLOSE</button>
                           </center>
                         </div>
                     </div>
                 </div>
             </div>

<%- include('../../../templates/CVO-Footer-Location.ejs') -%>
<script>
$(function (){
    $('.qr').on('click', function (){
        $('#modal_qr1').text("Impounding Site ID: "+$(this).data('qr1'))

    });
});
</script>
